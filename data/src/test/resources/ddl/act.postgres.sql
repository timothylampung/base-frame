DROP TABLE IF EXISTS ACT_GE_BYTEARRAY CASCADE;
DROP TABLE IF EXISTS ACT_GE_PROPERTY CASCADE;

DROP TABLE IF EXISTS ACT_RE_DEPLOYMENT CASCADE;
DROP TABLE IF EXISTS ACT_RE_MODEL CASCADE;
DROP TABLE IF EXISTS ACT_RE_PROCDEF CASCADE;
DROP TABLE IF EXISTS ACT_RU_EXECUTION CASCADE;
DROP TABLE IF EXISTS ACT_RU_EVENT_SUBSCR CASCADE;
DROP TABLE IF EXISTS ACT_EVT_LOG CASCADE;
DROP TABLE IF EXISTS ACT_PROCDEF_INFO CASCADE;

DROP TABLE IF EXISTS ACT_ID_PROPERTY CASCADE;
DROP TABLE IF EXISTS ACT_ID_BYTEARRAY CASCADE;
DROP TABLE IF EXISTS ACT_ID_INFO CASCADE;
DROP TABLE IF EXISTS ACT_ID_GROUP CASCADE;
DROP TABLE IF EXISTS ACT_ID_MEMBERSHIP CASCADE;
DROP TABLE IF EXISTS ACT_ID_USER CASCADE;
DROP TABLE IF EXISTS ACT_ID_TOKEN CASCADE;
DROP TABLE IF EXISTS ACT_ID_PRIV CASCADE;
DROP TABLE IF EXISTS ACT_ID_PRIV_MAPPING CASCADE;

DROP TABLE IF EXISTS ACT_HI_PROCINST CASCADE;
DROP TABLE IF EXISTS ACT_HI_ACTINST CASCADE;
DROP TABLE IF EXISTS ACT_HI_DETAIL CASCADE;
DROP TABLE IF EXISTS ACT_HI_COMMENT CASCADE;
DROP TABLE IF EXISTS ACT_HI_ATTACHMENT CASCADE;

DROP TABLE IF EXISTS ACT_RU_VARIABLE CASCADE;
DROP TABLE IF EXISTS ACT_HI_VARINST CASCADE;
DROP TABLE IF EXISTS ACT_RU_TASK CASCADE;
DROP TABLE IF EXISTS ACT_HI_TASKINST CASCADE;

DROP TABLE IF EXISTS ACT_RU_JOB CASCADE;
DROP TABLE IF EXISTS ACT_RU_TIMER_JOB CASCADE;
DROP TABLE IF EXISTS ACT_RU_SUSPENDED_JOB CASCADE;
DROP TABLE IF EXISTS ACT_RU_DEADLETTER_JOB CASCADE;
DROP TABLE IF EXISTS ACT_RU_HISTORY_JOB CASCADE;

DROP TABLE IF EXISTS ACT_RU_IDENTITYLINK CASCADE;
DROP TABLE IF EXISTS ACT_HI_IDENTITYLINK CASCADE;

CREATE TABLE ACT_GE_PROPERTY (
  NAME_  VARCHAR(64),
  VALUE_ VARCHAR(300),
  REV_   INTEGER,
  PRIMARY KEY (NAME_)
);

CREATE TABLE ACT_GE_BYTEARRAY (
  ID_            VARCHAR(64),
  REV_           INTEGER,
  NAME_          VARCHAR(255),
  DEPLOYMENT_ID_ VARCHAR(64),
  BYTES_         BYTEA,
  GENERATED_     BOOLEAN,
  PRIMARY KEY (ID_)
);

INSERT INTO ACT_GE_PROPERTY
VALUES ('common.schema.version', '6.2.0.0', 1);

INSERT INTO ACT_GE_PROPERTY
VALUES ('next.dbid', '1', 1);


CREATE TABLE ACT_RU_VARIABLE (
  ID_           VARCHAR(64)  NOT NULL,
  REV_          INTEGER,
  TYPE_         VARCHAR(255) NOT NULL,
  NAME_         VARCHAR(255) NOT NULL,
  EXECUTION_ID_ VARCHAR(64),
  PROC_INST_ID_ VARCHAR(64),
  TASK_ID_      VARCHAR(64),
  SCOPE_ID_     VARCHAR(255),
  SUB_SCOPE_ID_ VARCHAR(255),
  SCOPE_TYPE_   VARCHAR(255),
  BYTEARRAY_ID_ VARCHAR(64),
  DOUBLE_       DOUBLE PRECISION,
  LONG_         BIGINT,
  TEXT_         VARCHAR(4000),
  TEXT2_        VARCHAR(4000),
  PRIMARY KEY (ID_)
);

CREATE INDEX ACT_IDX_RU_VAR_SCOPE_ID_TYPE
  ON ACT_RU_VARIABLE (SCOPE_ID_, SCOPE_TYPE_);
CREATE INDEX ACT_IDX_RU_VAR_SUB_ID_TYPE
  ON ACT_RU_VARIABLE (SUB_SCOPE_ID_, SCOPE_TYPE_);

CREATE INDEX ACT_IDX_VAR_BYTEARRAY
  ON ACT_RU_VARIABLE (BYTEARRAY_ID_);
ALTER TABLE ACT_RU_VARIABLE
  ADD CONSTRAINT ACT_FK_VAR_BYTEARRAY
FOREIGN KEY (BYTEARRAY_ID_)
REFERENCES ACT_GE_BYTEARRAY (ID_);

INSERT INTO ACT_GE_PROPERTY VALUES ('variable.schema.version', '6.2.0.0', 1);

CREATE TABLE ACT_RE_DEPLOYMENT (
  ID_             VARCHAR(64),
  NAME_           VARCHAR(255),
  CATEGORY_       VARCHAR(255),
  KEY_            VARCHAR(255),
  TENANT_ID_      VARCHAR(255) DEFAULT '',
  DEPLOY_TIME_    TIMESTAMP,
  ENGINE_VERSION_ VARCHAR(255),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_RE_MODEL (
  ID_                           VARCHAR(64) NOT NULL,
  REV_                          INTEGER,
  NAME_                         VARCHAR(255),
  KEY_                          VARCHAR(255),
  CATEGORY_                     VARCHAR(255),
  CREATE_TIME_                  TIMESTAMP,
  LAST_UPDATE_TIME_             TIMESTAMP,
  VERSION_                      INTEGER,
  META_INFO_                    VARCHAR(4000),
  DEPLOYMENT_ID_                VARCHAR(64),
  EDITOR_SOURCE_VALUE_ID_       VARCHAR(64),
  EDITOR_SOURCE_EXTRA_VALUE_ID_ VARCHAR(64),
  TENANT_ID_                    VARCHAR(255) DEFAULT '',
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_RU_EXECUTION (
  ID_                   VARCHAR(64),
  REV_                  INTEGER,
  PROC_INST_ID_         VARCHAR(64),
  BUSINESS_KEY_         VARCHAR(255),
  PARENT_ID_            VARCHAR(64),
  PROC_DEF_ID_          VARCHAR(64),
  SUPER_EXEC_           VARCHAR(64),
  ROOT_PROC_INST_ID_    VARCHAR(64),
  ACT_ID_               VARCHAR(255),
  IS_ACTIVE_            BOOLEAN,
  IS_CONCURRENT_        BOOLEAN,
  IS_SCOPE_             BOOLEAN,
  IS_EVENT_SCOPE_       BOOLEAN,
  IS_MI_ROOT_           BOOLEAN,
  SUSPENSION_STATE_     INTEGER,
  CACHED_ENT_STATE_     INTEGER,
  TENANT_ID_            VARCHAR(255) DEFAULT '',
  NAME_                 VARCHAR(255),
  START_ACT_ID_         VARCHAR(255),
  START_TIME_           TIMESTAMP,
  START_USER_ID_        VARCHAR(255),
  LOCK_TIME_            TIMESTAMP,
  IS_COUNT_ENABLED_     BOOLEAN,
  EVT_SUBSCR_COUNT_     INTEGER,
  TASK_COUNT_           INTEGER,
  JOB_COUNT_            INTEGER,
  TIMER_JOB_COUNT_      INTEGER,
  SUSP_JOB_COUNT_       INTEGER,
  DEADLETTER_JOB_COUNT_ INTEGER,
  VAR_COUNT_            INTEGER,
  ID_LINK_COUNT_        INTEGER,
  CALLBACK_ID_          VARCHAR(255),
  CALLBACK_TYPE_        VARCHAR(255),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_RE_PROCDEF (
  ID_                     VARCHAR(64)  NOT NULL,
  REV_                    INTEGER,
  CATEGORY_               VARCHAR(255),
  NAME_                   VARCHAR(255),
  KEY_                    VARCHAR(255) NOT NULL,
  VERSION_                INTEGER      NOT NULL,
  DEPLOYMENT_ID_          VARCHAR(64),
  RESOURCE_NAME_          VARCHAR(4000),
  DGRM_RESOURCE_NAME_     VARCHAR(4000),
  DESCRIPTION_            VARCHAR(4000),
  HAS_START_FORM_KEY_     BOOLEAN,
  HAS_GRAPHICAL_NOTATION_ BOOLEAN,
  SUSPENSION_STATE_       INTEGER,
  TENANT_ID_              VARCHAR(255) DEFAULT '',
  ENGINE_VERSION_         VARCHAR(255),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_RU_EVENT_SUBSCR (
  ID_            VARCHAR(64)  NOT NULL,
  REV_           INTEGER,
  EVENT_TYPE_    VARCHAR(255) NOT NULL,
  EVENT_NAME_    VARCHAR(255),
  EXECUTION_ID_  VARCHAR(64),
  PROC_INST_ID_  VARCHAR(64),
  ACTIVITY_ID_   VARCHAR(64),
  CONFIGURATION_ VARCHAR(255),
  CREATED_       TIMESTAMP    NOT NULL,
  PROC_DEF_ID_   VARCHAR(64),
  TENANT_ID_     VARCHAR(255) DEFAULT '',
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_EVT_LOG (
  LOG_NR_       SERIAL PRIMARY KEY,
  TYPE_         VARCHAR(64),
  PROC_DEF_ID_  VARCHAR(64),
  PROC_INST_ID_ VARCHAR(64),
  EXECUTION_ID_ VARCHAR(64),
  TASK_ID_      VARCHAR(64),
  TIME_STAMP_   TIMESTAMP NOT NULL,
  USER_ID_      VARCHAR(255),
  DATA_         BYTEA,
  LOCK_OWNER_   VARCHAR(255),
  LOCK_TIME_    TIMESTAMP NULL,
  IS_PROCESSED_ SMALLINT DEFAULT 0
);

CREATE TABLE ACT_PROCDEF_INFO (
  ID_           VARCHAR(64) NOT NULL,
  PROC_DEF_ID_  VARCHAR(64) NOT NULL,
  REV_          INTEGER,
  INFO_JSON_ID_ VARCHAR(64),
  PRIMARY KEY (ID_)
);

CREATE INDEX ACT_IDX_EXEC_BUSKEY
  ON ACT_RU_EXECUTION (BUSINESS_KEY_);
CREATE INDEX ACT_IDX_EXE_ROOT
  ON ACT_RU_EXECUTION (ROOT_PROC_INST_ID_);
CREATE INDEX ACT_IDX_EVENT_SUBSCR_CONFIG_
  ON ACT_RU_EVENT_SUBSCR (CONFIGURATION_);
CREATE INDEX ACT_IDX_VARIABLE_TASK_ID
  ON ACT_RU_VARIABLE (TASK_ID_);

CREATE INDEX ACT_IDX_BYTEAR_DEPL
  ON ACT_GE_BYTEARRAY (DEPLOYMENT_ID_);
ALTER TABLE ACT_GE_BYTEARRAY
  ADD CONSTRAINT ACT_FK_BYTEARR_DEPL
FOREIGN KEY (DEPLOYMENT_ID_)
REFERENCES ACT_RE_DEPLOYMENT (ID_);

ALTER TABLE ACT_RE_PROCDEF
  ADD CONSTRAINT ACT_UNIQ_PROCDEF
UNIQUE (KEY_, VERSION_, TENANT_ID_);

CREATE INDEX ACT_IDX_EXE_PROCINST
  ON ACT_RU_EXECUTION (PROC_INST_ID_);
ALTER TABLE ACT_RU_EXECUTION
  ADD CONSTRAINT ACT_FK_EXE_PROCINST
FOREIGN KEY (PROC_INST_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_EXE_PARENT
  ON ACT_RU_EXECUTION (PARENT_ID_);
ALTER TABLE ACT_RU_EXECUTION
  ADD CONSTRAINT ACT_FK_EXE_PARENT
FOREIGN KEY (PARENT_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_EXE_SUPER
  ON ACT_RU_EXECUTION (SUPER_EXEC_);
ALTER TABLE ACT_RU_EXECUTION
  ADD CONSTRAINT ACT_FK_EXE_SUPER
FOREIGN KEY (SUPER_EXEC_)
REFERENCES ACT_RU_EXECUTION (ID_);


CREATE INDEX ACT_IDX_EXE_PROCDEF
  ON ACT_RU_EXECUTION (PROC_DEF_ID_);
ALTER TABLE ACT_RU_EXECUTION
  ADD CONSTRAINT ACT_FK_EXE_PROCDEF
FOREIGN KEY (PROC_DEF_ID_)
REFERENCES ACT_RE_PROCDEF (ID_);


CREATE INDEX ACT_IDX_VAR_EXE
  ON ACT_RU_VARIABLE (EXECUTION_ID_);
ALTER TABLE ACT_RU_VARIABLE
  ADD CONSTRAINT ACT_FK_VAR_EXE
FOREIGN KEY (EXECUTION_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_VAR_PROCINST
  ON ACT_RU_VARIABLE (PROC_INST_ID_);
ALTER TABLE ACT_RU_VARIABLE
  ADD CONSTRAINT ACT_FK_VAR_PROCINST
FOREIGN KEY (PROC_INST_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);


CREATE INDEX ACT_IDX_EVENT_SUBSCR
  ON ACT_RU_EVENT_SUBSCR (EXECUTION_ID_);
ALTER TABLE ACT_RU_EVENT_SUBSCR
  ADD CONSTRAINT ACT_FK_EVENT_EXEC
FOREIGN KEY (EXECUTION_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_MODEL_SOURCE
  ON ACT_RE_MODEL (EDITOR_SOURCE_VALUE_ID_);
ALTER TABLE ACT_RE_MODEL
  ADD CONSTRAINT ACT_FK_MODEL_SOURCE
FOREIGN KEY (EDITOR_SOURCE_VALUE_ID_)
REFERENCES ACT_GE_BYTEARRAY (ID_);

CREATE INDEX ACT_IDX_MODEL_SOURCE_EXTRA
  ON ACT_RE_MODEL (EDITOR_SOURCE_EXTRA_VALUE_ID_);
ALTER TABLE ACT_RE_MODEL
  ADD CONSTRAINT ACT_FK_MODEL_SOURCE_EXTRA
FOREIGN KEY (EDITOR_SOURCE_EXTRA_VALUE_ID_)
REFERENCES ACT_GE_BYTEARRAY (ID_);

CREATE INDEX ACT_IDX_MODEL_DEPLOYMENT
  ON ACT_RE_MODEL (DEPLOYMENT_ID_);
ALTER TABLE ACT_RE_MODEL
  ADD CONSTRAINT ACT_FK_MODEL_DEPLOYMENT
FOREIGN KEY (DEPLOYMENT_ID_)
REFERENCES ACT_RE_DEPLOYMENT (ID_);

CREATE INDEX ACT_IDX_PROCDEF_INFO_JSON
  ON ACT_PROCDEF_INFO (INFO_JSON_ID_);
ALTER TABLE ACT_PROCDEF_INFO
  ADD CONSTRAINT ACT_FK_INFO_JSON_BA
FOREIGN KEY (INFO_JSON_ID_)
REFERENCES ACT_GE_BYTEARRAY (ID_);

CREATE INDEX ACT_IDX_PROCDEF_INFO_PROC
  ON ACT_PROCDEF_INFO (PROC_DEF_ID_);
ALTER TABLE ACT_PROCDEF_INFO
  ADD CONSTRAINT ACT_FK_INFO_PROCDEF
FOREIGN KEY (PROC_DEF_ID_)
REFERENCES ACT_RE_PROCDEF (ID_);

ALTER TABLE ACT_PROCDEF_INFO
  ADD CONSTRAINT ACT_UNIQ_INFO_PROCDEF
UNIQUE (PROC_DEF_ID_);

INSERT INTO ACT_GE_PROPERTY
VALUES ('schema.version', '6.2.0.0', 1);

INSERT INTO ACT_GE_PROPERTY
VALUES ('schema.history', 'create(6.2.0.0)', 1);

CREATE TABLE ACT_HI_PROCINST (
  ID_                        VARCHAR(64) NOT NULL,
  REV_                       INTEGER      DEFAULT 1,
  PROC_INST_ID_              VARCHAR(64) NOT NULL,
  BUSINESS_KEY_              VARCHAR(255),
  PROC_DEF_ID_               VARCHAR(64) NOT NULL,
  START_TIME_                TIMESTAMP   NOT NULL,
  END_TIME_                  TIMESTAMP,
  DURATION_                  BIGINT,
  START_USER_ID_             VARCHAR(255),
  START_ACT_ID_              VARCHAR(255),
  END_ACT_ID_                VARCHAR(255),
  SUPER_PROCESS_INSTANCE_ID_ VARCHAR(64),
  DELETE_REASON_             VARCHAR(4000),
  TENANT_ID_                 VARCHAR(255) DEFAULT '',
  NAME_                      VARCHAR(255),
  CALLBACK_ID_               VARCHAR(255),
  CALLBACK_TYPE_             VARCHAR(255),
  PRIMARY KEY (ID_),
  UNIQUE (PROC_INST_ID_)
);

CREATE TABLE ACT_HI_ACTINST (
  ID_                VARCHAR(64)  NOT NULL,
  REV_               INTEGER      DEFAULT 1,
  PROC_DEF_ID_       VARCHAR(64)  NOT NULL,
  PROC_INST_ID_      VARCHAR(64)  NOT NULL,
  EXECUTION_ID_      VARCHAR(64)  NOT NULL,
  ACT_ID_            VARCHAR(255) NOT NULL,
  TASK_ID_           VARCHAR(64),
  CALL_PROC_INST_ID_ VARCHAR(64),
  ACT_NAME_          VARCHAR(255),
  ACT_TYPE_          VARCHAR(255) NOT NULL,
  ASSIGNEE_          VARCHAR(255),
  START_TIME_        TIMESTAMP    NOT NULL,
  END_TIME_          TIMESTAMP,
  DURATION_          BIGINT,
  DELETE_REASON_     VARCHAR(4000),
  TENANT_ID_         VARCHAR(255) DEFAULT '',
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_HI_DETAIL (
  ID_           VARCHAR(64)  NOT NULL,
  TYPE_         VARCHAR(255) NOT NULL,
  PROC_INST_ID_ VARCHAR(64),
  EXECUTION_ID_ VARCHAR(64),
  TASK_ID_      VARCHAR(64),
  ACT_INST_ID_  VARCHAR(64),
  NAME_         VARCHAR(255) NOT NULL,
  VAR_TYPE_     VARCHAR(64),
  REV_          INTEGER,
  TIME_         TIMESTAMP    NOT NULL,
  BYTEARRAY_ID_ VARCHAR(64),
  DOUBLE_       DOUBLE PRECISION,
  LONG_         BIGINT,
  TEXT_         VARCHAR(4000),
  TEXT2_        VARCHAR(4000),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_HI_COMMENT (
  ID_           VARCHAR(64) NOT NULL,
  TYPE_         VARCHAR(255),
  TIME_         TIMESTAMP   NOT NULL,
  USER_ID_      VARCHAR(255),
  TASK_ID_      VARCHAR(64),
  PROC_INST_ID_ VARCHAR(64),
  ACTION_       VARCHAR(255),
  MESSAGE_      VARCHAR(4000),
  FULL_MSG_     BYTEA,
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_HI_ATTACHMENT (
  ID_           VARCHAR(64) NOT NULL,
  REV_          INTEGER,
  USER_ID_      VARCHAR(255),
  NAME_         VARCHAR(255),
  DESCRIPTION_  VARCHAR(4000),
  TYPE_         VARCHAR(255),
  TASK_ID_      VARCHAR(64),
  PROC_INST_ID_ VARCHAR(64),
  URL_          VARCHAR(4000),
  CONTENT_ID_   VARCHAR(64),
  TIME_         TIMESTAMP,
  PRIMARY KEY (ID_)
);


CREATE TABLE ACT_ID_PROPERTY (
  NAME_  VARCHAR(64),
  VALUE_ VARCHAR(300),
  REV_   INTEGER,
  PRIMARY KEY (NAME_)
);

INSERT INTO ACT_ID_PROPERTY
VALUES ('schema.version', '6.2.0.0', 1);

CREATE TABLE ACT_ID_BYTEARRAY (
  ID_    VARCHAR(64),
  REV_   INTEGER,
  NAME_  VARCHAR(255),
  BYTES_ BYTEA,
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_ID_GROUP (
  ID_   VARCHAR(64),
  REV_  INTEGER,
  NAME_ VARCHAR(255),
  TYPE_ VARCHAR(255),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_ID_MEMBERSHIP (
  USER_ID_  VARCHAR(64),
  GROUP_ID_ VARCHAR(64),
  PRIMARY KEY (USER_ID_, GROUP_ID_)
);

CREATE TABLE ACT_ID_USER (
  ID_         VARCHAR(64),
  REV_        INTEGER,
  FIRST_      VARCHAR(255),
  LAST_       VARCHAR(255),
  EMAIL_      VARCHAR(255),
  PWD_        VARCHAR(255),
  PICTURE_ID_ VARCHAR(64),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_ID_INFO (
  ID_        VARCHAR(64),
  REV_       INTEGER,
  USER_ID_   VARCHAR(64),
  TYPE_      VARCHAR(64),
  KEY_       VARCHAR(255),
  VALUE_     VARCHAR(255),
  PASSWORD_  BYTEA,
  PARENT_ID_ VARCHAR(255),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_ID_TOKEN (
  ID_          VARCHAR(64) NOT NULL,
  REV_         INTEGER,
  TOKEN_VALUE_ VARCHAR(255),
  TOKEN_DATE_  TIMESTAMP,
  IP_ADDRESS_  VARCHAR(255),
  USER_AGENT_  VARCHAR(255),
  USER_ID_     VARCHAR(255),
  TOKEN_DATA_  VARCHAR(2000),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_ID_PRIV (
  ID_   VARCHAR(64) NOT NULL,
  NAME_ VARCHAR(255),
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_ID_PRIV_MAPPING (
  ID_       VARCHAR(64) NOT NULL,
  PRIV_ID_  VARCHAR(64) NOT NULL,
  USER_ID_  VARCHAR(255),
  GROUP_ID_ VARCHAR(255),
  PRIMARY KEY (ID_)
);

CREATE INDEX ACT_IDX_MEMB_GROUP
  ON ACT_ID_MEMBERSHIP (GROUP_ID_);
ALTER TABLE ACT_ID_MEMBERSHIP
  ADD CONSTRAINT ACT_FK_MEMB_GROUP
FOREIGN KEY (GROUP_ID_)
REFERENCES ACT_ID_GROUP (ID_);

CREATE INDEX ACT_IDX_MEMB_USER
  ON ACT_ID_MEMBERSHIP (USER_ID_);
ALTER TABLE ACT_ID_MEMBERSHIP
  ADD CONSTRAINT ACT_FK_MEMB_USER
FOREIGN KEY (USER_ID_)
REFERENCES ACT_ID_USER (ID_);

CREATE INDEX ACT_IDX_PRIV_MAPPING
  ON ACT_ID_PRIV_MAPPING (PRIV_ID_);
ALTER TABLE ACT_ID_PRIV_MAPPING
  ADD CONSTRAINT ACT_FK_PRIV_MAPPING
FOREIGN KEY (PRIV_ID_)
REFERENCES ACT_ID_PRIV (ID_);

CREATE INDEX ACT_IDX_PRIV_USER
  ON ACT_ID_PRIV_MAPPING (USER_ID_);
CREATE INDEX ACT_IDX_PRIV_GROUP
  ON ACT_ID_PRIV_MAPPING (GROUP_ID_);

CREATE TABLE ACT_HI_IDENTITYLINK (
  ID_           VARCHAR(64),
  GROUP_ID_     VARCHAR(255),
  TYPE_         VARCHAR(255),
  USER_ID_      VARCHAR(255),
  TASK_ID_      VARCHAR(64),
  CREATE_TIME_  TIMESTAMP,
  PROC_INST_ID_ VARCHAR(64),
  PRIMARY KEY (ID_)
);

CREATE INDEX ACT_IDX_HI_IDENT_LNK_USER
  ON ACT_HI_IDENTITYLINK (USER_ID_);

CREATE TABLE ACT_RU_JOB (
  ID_                  VARCHAR(64)  NOT NULL,
  REV_                 INTEGER,
  TYPE_                VARCHAR(255) NOT NULL,
  LOCK_EXP_TIME_       TIMESTAMP,
  LOCK_OWNER_          VARCHAR(255),
  EXCLUSIVE_           BOOLEAN,
  EXECUTION_ID_        VARCHAR(64),
  PROCESS_INSTANCE_ID_ VARCHAR(64),
  PROC_DEF_ID_         VARCHAR(64),
  RETRIES_             INTEGER,
  EXCEPTION_STACK_ID_  VARCHAR(64),
  EXCEPTION_MSG_       VARCHAR(4000),
  DUEDATE_             TIMESTAMP,
  REPEAT_              VARCHAR(255),
  HANDLER_TYPE_        VARCHAR(255),
  HANDLER_CFG_         VARCHAR(4000),
  CREATE_TIME_         TIMESTAMP,
  TENANT_ID_           VARCHAR(255) DEFAULT '',
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_RU_TIMER_JOB (
  ID_                  VARCHAR(64)  NOT NULL,
  REV_                 INTEGER,
  TYPE_                VARCHAR(255) NOT NULL,
  LOCK_EXP_TIME_       TIMESTAMP,
  LOCK_OWNER_          VARCHAR(255),
  EXCLUSIVE_           BOOLEAN,
  EXECUTION_ID_        VARCHAR(64),
  PROCESS_INSTANCE_ID_ VARCHAR(64),
  PROC_DEF_ID_         VARCHAR(64),
  RETRIES_             INTEGER,
  EXCEPTION_STACK_ID_  VARCHAR(64),
  EXCEPTION_MSG_       VARCHAR(4000),
  DUEDATE_             TIMESTAMP,
  REPEAT_              VARCHAR(255),
  HANDLER_TYPE_        VARCHAR(255),
  HANDLER_CFG_         VARCHAR(4000),
  CREATE_TIME_         TIMESTAMP,
  TENANT_ID_           VARCHAR(255) DEFAULT '',
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_RU_SUSPENDED_JOB (
  ID_                  VARCHAR(64)  NOT NULL,
  REV_                 INTEGER,
  TYPE_                VARCHAR(255) NOT NULL,
  EXCLUSIVE_           BOOLEAN,
  EXECUTION_ID_        VARCHAR(64),
  PROCESS_INSTANCE_ID_ VARCHAR(64),
  PROC_DEF_ID_         VARCHAR(64),
  RETRIES_             INTEGER,
  EXCEPTION_STACK_ID_  VARCHAR(64),
  EXCEPTION_MSG_       VARCHAR(4000),
  DUEDATE_             TIMESTAMP,
  REPEAT_              VARCHAR(255),
  HANDLER_TYPE_        VARCHAR(255),
  HANDLER_CFG_         VARCHAR(4000),
  CREATE_TIME_         TIMESTAMP,
  TENANT_ID_           VARCHAR(255) DEFAULT '',
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_RU_DEADLETTER_JOB (
  ID_                  VARCHAR(64)  NOT NULL,
  REV_                 INTEGER,
  TYPE_                VARCHAR(255) NOT NULL,
  EXCLUSIVE_           BOOLEAN,
  EXECUTION_ID_        VARCHAR(64),
  PROCESS_INSTANCE_ID_ VARCHAR(64),
  PROC_DEF_ID_         VARCHAR(64),
  EXCEPTION_STACK_ID_  VARCHAR(64),
  EXCEPTION_MSG_       VARCHAR(4000),
  DUEDATE_             TIMESTAMP,
  REPEAT_              VARCHAR(255),
  HANDLER_TYPE_        VARCHAR(255),
  HANDLER_CFG_         VARCHAR(4000),
  CREATE_TIME_         TIMESTAMP,
  TENANT_ID_           VARCHAR(255) DEFAULT '',
  PRIMARY KEY (ID_)
);

CREATE TABLE ACT_RU_HISTORY_JOB (
  ID_                 VARCHAR(64) NOT NULL,
  REV_                INTEGER,
  LOCK_EXP_TIME_      TIMESTAMP,
  LOCK_OWNER_         VARCHAR(255),
  RETRIES_            INTEGER,
  EXCEPTION_STACK_ID_ VARCHAR(64),
  EXCEPTION_MSG_      VARCHAR(4000),
  HANDLER_TYPE_       VARCHAR(255),
  HANDLER_CFG_        VARCHAR(4000),
  ADV_HANDLER_CFG_ID_ VARCHAR(64),
  CREATE_TIME_        TIMESTAMP,
  TENANT_ID_          VARCHAR(255) DEFAULT '',
  PRIMARY KEY (ID_)
);

CREATE INDEX ACT_IDX_JOB_EXCEPTION
  ON ACT_RU_JOB (EXCEPTION_STACK_ID_);
ALTER TABLE ACT_RU_JOB
  ADD CONSTRAINT ACT_FK_JOB_EXCEPTION
FOREIGN KEY (EXCEPTION_STACK_ID_)
REFERENCES ACT_GE_BYTEARRAY (ID_);

CREATE INDEX ACT_IDX_TIMER_JOB_EXCEPTION
  ON ACT_RU_TIMER_JOB (EXCEPTION_STACK_ID_);
ALTER TABLE ACT_RU_TIMER_JOB
  ADD CONSTRAINT ACT_FK_TIMER_JOB_EXCEPTION
FOREIGN KEY (EXCEPTION_STACK_ID_)
REFERENCES ACT_GE_BYTEARRAY (ID_);

CREATE INDEX ACT_IDX_SUSPENDED_JOB_EXCEPTION
  ON ACT_RU_SUSPENDED_JOB (EXCEPTION_STACK_ID_);
ALTER TABLE ACT_RU_SUSPENDED_JOB
  ADD CONSTRAINT ACT_FK_SUSPENDED_JOB_EXCEPTION
FOREIGN KEY (EXCEPTION_STACK_ID_)
REFERENCES ACT_GE_BYTEARRAY (ID_);

CREATE INDEX ACT_IDX_DEADLETTER_JOB_EXCEPTION
  ON ACT_RU_DEADLETTER_JOB (EXCEPTION_STACK_ID_);
ALTER TABLE ACT_RU_DEADLETTER_JOB
  ADD CONSTRAINT ACT_FK_DEADLETTER_JOB_EXCEPTION
FOREIGN KEY (EXCEPTION_STACK_ID_)
REFERENCES ACT_GE_BYTEARRAY (ID_);

INSERT INTO ACT_GE_PROPERTY VALUES ('job.schema.version', '6.2.0.0', 1);

CREATE TABLE ACT_HI_TASKINST (
  ID_                  VARCHAR(64) NOT NULL,
  REV_                 INTEGER      DEFAULT 1,
  PROC_DEF_ID_         VARCHAR(64),
  TASK_DEF_KEY_        VARCHAR(255),
  PROC_INST_ID_        VARCHAR(64),
  EXECUTION_ID_        VARCHAR(64),
  SCOPE_ID_            VARCHAR(255),
  SUB_SCOPE_ID_        VARCHAR(255),
  SCOPE_TYPE_          VARCHAR(255),
  SCOPE_DEFINITION_ID_ VARCHAR(255),
  NAME_                VARCHAR(255),
  PARENT_TASK_ID_      VARCHAR(64),
  DESCRIPTION_         VARCHAR(4000),
  OWNER_               VARCHAR(255),
  ASSIGNEE_            VARCHAR(255),
  START_TIME_          TIMESTAMP   NOT NULL,
  CLAIM_TIME_          TIMESTAMP,
  END_TIME_            TIMESTAMP,
  DURATION_            BIGINT,
  DELETE_REASON_       VARCHAR(4000),
  PRIORITY_            INTEGER,
  DUE_DATE_            TIMESTAMP,
  FORM_KEY_            VARCHAR(255),
  CATEGORY_            VARCHAR(255),
  TENANT_ID_           VARCHAR(255) DEFAULT '',
  LAST_UPDATED_TIME_   TIMESTAMP,
  PRIMARY KEY (ID_)
);

CREATE INDEX ACT_IDX_HI_TASK_SCOPE
  ON ACT_HI_TASKINST (SCOPE_ID_, SCOPE_TYPE_);
CREATE INDEX ACT_IDX_HI_TASK_SUB_SCOPE
  ON ACT_HI_TASKINST (SUB_SCOPE_ID_, SCOPE_TYPE_);
CREATE INDEX ACT_IDX_HI_TASK_SCOPE_DEF
  ON ACT_HI_TASKINST (SCOPE_DEFINITION_ID_, SCOPE_TYPE_);

CREATE TABLE ACT_RU_TASK (
  ID_                  VARCHAR(64),
  REV_                 INTEGER,
  EXECUTION_ID_        VARCHAR(64),
  PROC_INST_ID_        VARCHAR(64),
  PROC_DEF_ID_         VARCHAR(64),
  SCOPE_ID_            VARCHAR(255),
  SUB_SCOPE_ID_        VARCHAR(255),
  SCOPE_TYPE_          VARCHAR(255),
  SCOPE_DEFINITION_ID_ VARCHAR(255),
  NAME_                VARCHAR(255),
  PARENT_TASK_ID_      VARCHAR(64),
  DESCRIPTION_         VARCHAR(4000),
  TASK_DEF_KEY_        VARCHAR(255),
  OWNER_               VARCHAR(255),
  ASSIGNEE_            VARCHAR(255),
  DELEGATION_          VARCHAR(64),
  PRIORITY_            INTEGER,
  CREATE_TIME_         TIMESTAMP,
  DUE_DATE_            TIMESTAMP,
  CATEGORY_            VARCHAR(255),
  SUSPENSION_STATE_    INTEGER,
  TENANT_ID_           VARCHAR(255) DEFAULT '',
  FORM_KEY_            VARCHAR(255),
  CLAIM_TIME_          TIMESTAMP,
  IS_COUNT_ENABLED_    BOOLEAN,
  VAR_COUNT_           INTEGER,
  ID_LINK_COUNT_       INTEGER,
  PRIMARY KEY (ID_)
);

CREATE INDEX ACT_IDX_TASK_CREATE
  ON ACT_RU_TASK (CREATE_TIME_);
CREATE INDEX ACT_IDX_TASK_SCOPE
  ON ACT_RU_TASK (SCOPE_ID_, SCOPE_TYPE_);
CREATE INDEX ACT_IDX_TASK_SUB_SCOPE
  ON ACT_RU_TASK (SUB_SCOPE_ID_, SCOPE_TYPE_);
CREATE INDEX ACT_IDX_TASK_SCOPE_DEF
  ON ACT_RU_TASK (SCOPE_DEFINITION_ID_, SCOPE_TYPE_);

INSERT INTO ACT_GE_PROPERTY VALUES ('task.schema.version', '6.2.0.0', 1);

CREATE TABLE ACT_HI_VARINST (
  ID_                VARCHAR(64)  NOT NULL,
  REV_               INTEGER DEFAULT 1,
  PROC_INST_ID_      VARCHAR(64),
  EXECUTION_ID_      VARCHAR(64),
  TASK_ID_           VARCHAR(64),
  NAME_              VARCHAR(255) NOT NULL,
  VAR_TYPE_          VARCHAR(100),
  SCOPE_ID_          VARCHAR(255),
  SUB_SCOPE_ID_      VARCHAR(255),
  SCOPE_TYPE_        VARCHAR(255),
  BYTEARRAY_ID_      VARCHAR(64),
  DOUBLE_            DOUBLE PRECISION,
  LONG_              BIGINT,
  TEXT_              VARCHAR(4000),
  TEXT2_             VARCHAR(4000),
  CREATE_TIME_       TIMESTAMP,
  LAST_UPDATED_TIME_ TIMESTAMP,
  PRIMARY KEY (ID_)
);


CREATE TABLE ACT_RU_IDENTITYLINK (
  ID_           VARCHAR(64),
  REV_          INTEGER,
  GROUP_ID_     VARCHAR(255),
  TYPE_         VARCHAR(255),
  USER_ID_      VARCHAR(255),
  TASK_ID_      VARCHAR(64),
  PROC_INST_ID_ VARCHAR(64),
  PROC_DEF_ID_  VARCHAR(64),
  PRIMARY KEY (ID_)
);

CREATE INDEX ACT_IDX_IDENT_LNK_USER
  ON ACT_RU_IDENTITYLINK (USER_ID_);
CREATE INDEX ACT_IDX_IDENT_LNK_GROUP
  ON ACT_RU_IDENTITYLINK (GROUP_ID_);

INSERT INTO ACT_GE_PROPERTY VALUES ('identitylink.schema.version', '6.2.0.0', 1);

CREATE INDEX ACT_IDX_HI_PROCVAR_NAME_TYPE
  ON ACT_HI_VARINST (NAME_, VAR_TYPE_);
CREATE INDEX ACT_IDX_HI_VAR_SCOPE_ID_TYPE
  ON ACT_HI_VARINST (SCOPE_ID_, SCOPE_TYPE_);
CREATE INDEX ACT_IDX_HI_VAR_SUB_ID_TYPE
  ON ACT_HI_VARINST (SUB_SCOPE_ID_, SCOPE_TYPE_);


CREATE INDEX ACT_IDX_TSKASS_TASK
  ON ACT_RU_IDENTITYLINK (TASK_ID_);
ALTER TABLE ACT_RU_IDENTITYLINK
  ADD CONSTRAINT ACT_FK_TSKASS_TASK
FOREIGN KEY (TASK_ID_)
REFERENCES ACT_RU_TASK (ID_);

CREATE INDEX ACT_IDX_ATHRZ_PROCEDEF
  ON ACT_RU_IDENTITYLINK (PROC_DEF_ID_);
ALTER TABLE ACT_RU_IDENTITYLINK
  ADD CONSTRAINT ACT_FK_ATHRZ_PROCEDEF
FOREIGN KEY (PROC_DEF_ID_)
REFERENCES ACT_RE_PROCDEF (ID_);

CREATE INDEX ACT_IDX_IDL_PROCINST
  ON ACT_RU_IDENTITYLINK (PROC_INST_ID_);
ALTER TABLE ACT_RU_IDENTITYLINK
  ADD CONSTRAINT ACT_FK_IDL_PROCINST
FOREIGN KEY (PROC_INST_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_TASK_EXEC
  ON ACT_RU_TASK (EXECUTION_ID_);

ALTER TABLE ACT_RU_TASK
  ADD CONSTRAINT ACT_FK_TASK_EXE
FOREIGN KEY (EXECUTION_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_TASK_PROCINST
  ON ACT_RU_TASK (PROC_INST_ID_);
ALTER TABLE ACT_RU_TASK
  ADD CONSTRAINT ACT_FK_TASK_PROCINST
FOREIGN KEY (PROC_INST_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_TASK_PROCDEF
  ON ACT_RU_TASK (PROC_DEF_ID_);
ALTER TABLE ACT_RU_TASK
  ADD CONSTRAINT ACT_FK_TASK_PROCDEF
FOREIGN KEY (PROC_DEF_ID_)
REFERENCES ACT_RE_PROCDEF (ID_);

CREATE INDEX ACT_IDX_JOB_EXECUTION_ID
  ON ACT_RU_JOB (EXECUTION_ID_);
ALTER TABLE ACT_RU_JOB
  ADD CONSTRAINT ACT_FK_JOB_EXECUTION
FOREIGN KEY (EXECUTION_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_JOB_PROCESS_INSTANCE_ID
  ON ACT_RU_JOB (PROCESS_INSTANCE_ID_);
ALTER TABLE ACT_RU_JOB
  ADD CONSTRAINT ACT_FK_JOB_PROCESS_INSTANCE
FOREIGN KEY (PROCESS_INSTANCE_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_JOB_PROC_DEF_ID
  ON ACT_RU_JOB (PROC_DEF_ID_);
ALTER TABLE ACT_RU_JOB
  ADD CONSTRAINT ACT_FK_JOB_PROC_DEF
FOREIGN KEY (PROC_DEF_ID_)
REFERENCES ACT_RE_PROCDEF (ID_);

CREATE INDEX ACT_IDX_TIMER_JOB_EXECUTION_ID
  ON ACT_RU_TIMER_JOB (EXECUTION_ID_);
ALTER TABLE ACT_RU_TIMER_JOB
  ADD CONSTRAINT ACT_FK_TIMER_JOB_EXECUTION
FOREIGN KEY (EXECUTION_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_TIMER_JOB_PROCESS_INSTANCE_ID
  ON ACT_RU_TIMER_JOB (PROCESS_INSTANCE_ID_);
ALTER TABLE ACT_RU_TIMER_JOB
  ADD CONSTRAINT ACT_FK_TIMER_JOB_PROCESS_INSTANCE
FOREIGN KEY (PROCESS_INSTANCE_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_TIMER_JOB_PROC_DEF_ID
  ON ACT_RU_TIMER_JOB (PROC_DEF_ID_);
ALTER TABLE ACT_RU_TIMER_JOB
  ADD CONSTRAINT ACT_FK_TIMER_JOB_PROC_DEF
FOREIGN KEY (PROC_DEF_ID_)
REFERENCES ACT_RE_PROCDEF (ID_);

CREATE INDEX ACT_IDX_SUSPENDED_JOB_EXECUTION_ID
  ON ACT_RU_SUSPENDED_JOB (EXECUTION_ID_);
ALTER TABLE ACT_RU_SUSPENDED_JOB
  ADD CONSTRAINT ACT_FK_SUSPENDED_JOB_EXECUTION
FOREIGN KEY (EXECUTION_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_SUSPENDED_JOB_PROCESS_INSTANCE_ID
  ON ACT_RU_SUSPENDED_JOB (PROCESS_INSTANCE_ID_);
ALTER TABLE ACT_RU_SUSPENDED_JOB
  ADD CONSTRAINT ACT_FK_SUSPENDED_JOB_PROCESS_INSTANCE
FOREIGN KEY (PROCESS_INSTANCE_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_SUSPENDED_JOB_PROC_DEF_ID
  ON ACT_RU_SUSPENDED_JOB (PROC_DEF_ID_);
ALTER TABLE ACT_RU_SUSPENDED_JOB
  ADD CONSTRAINT ACT_FK_SUSPENDED_JOB_PROC_DEF
FOREIGN KEY (PROC_DEF_ID_)
REFERENCES ACT_RE_PROCDEF (ID_);

CREATE INDEX ACT_IDX_DEADLETTER_JOB_EXECUTION_ID
  ON ACT_RU_DEADLETTER_JOB (EXECUTION_ID_);
ALTER TABLE ACT_RU_DEADLETTER_JOB
  ADD CONSTRAINT ACT_FK_DEADLETTER_JOB_EXECUTION
FOREIGN KEY (EXECUTION_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_DEADLETTER_JOB_PROCESS_INSTANCE_ID
  ON ACT_RU_DEADLETTER_JOB (PROCESS_INSTANCE_ID_);
ALTER TABLE ACT_RU_DEADLETTER_JOB
  ADD CONSTRAINT ACT_FK_DEADLETTER_JOB_PROCESS_INSTANCE
FOREIGN KEY (PROCESS_INSTANCE_ID_)
REFERENCES ACT_RU_EXECUTION (ID_);

CREATE INDEX ACT_IDX_DEADLETTER_JOB_PROC_DEF_ID
  ON ACT_RU_DEADLETTER_JOB (PROC_DEF_ID_);
ALTER TABLE ACT_RU_DEADLETTER_JOB
  ADD CONSTRAINT ACT_FK_DEADLETTER_JOB_PROC_DEF
FOREIGN KEY (PROC_DEF_ID_)
REFERENCES ACT_RE_PROCDEF (ID_);

CREATE INDEX ACT_IDX_HI_PRO_INST_END
  ON ACT_HI_PROCINST (END_TIME_);
CREATE INDEX ACT_IDX_HI_PRO_I_BUSKEY
  ON ACT_HI_PROCINST (BUSINESS_KEY_);
CREATE INDEX ACT_IDX_HI_ACT_INST_START
  ON ACT_HI_ACTINST (START_TIME_);
CREATE INDEX ACT_IDX_HI_ACT_INST_END
  ON ACT_HI_ACTINST (END_TIME_);
CREATE INDEX ACT_IDX_HI_DETAIL_PROC_INST
  ON ACT_HI_DETAIL (PROC_INST_ID_);
CREATE INDEX ACT_IDX_HI_DETAIL_ACT_INST
  ON ACT_HI_DETAIL (ACT_INST_ID_);
CREATE INDEX ACT_IDX_HI_DETAIL_TIME
  ON ACT_HI_DETAIL (TIME_);
CREATE INDEX ACT_IDX_HI_DETAIL_NAME
  ON ACT_HI_DETAIL (NAME_);
CREATE INDEX ACT_IDX_HI_DETAIL_TASK_ID
  ON ACT_HI_DETAIL (TASK_ID_);
CREATE INDEX ACT_IDX_HI_PROCVAR_PROC_INST
  ON ACT_HI_VARINST (PROC_INST_ID_);
CREATE INDEX ACT_IDX_HI_PROCVAR_TASK_ID
  ON ACT_HI_VARINST (TASK_ID_);
CREATE INDEX ACT_IDX_HI_PROCVAR_EXE
  ON ACT_HI_VARINST (EXECUTION_ID_);
CREATE INDEX ACT_IDX_HI_ACT_INST_PROCINST
  ON ACT_HI_ACTINST (PROC_INST_ID_, ACT_ID_);
CREATE INDEX ACT_IDX_HI_ACT_INST_EXEC
  ON ACT_HI_ACTINST (EXECUTION_ID_, ACT_ID_);
CREATE INDEX ACT_IDX_HI_IDENT_LNK_TASK
  ON ACT_HI_IDENTITYLINK (TASK_ID_);
CREATE INDEX ACT_IDX_HI_IDENT_LNK_PROCINST
  ON ACT_HI_IDENTITYLINK (PROC_INST_ID_);
CREATE INDEX ACT_IDX_HI_TASK_INST_PROCINST
  ON ACT_HI_TASKINST (PROC_INST_ID_);
